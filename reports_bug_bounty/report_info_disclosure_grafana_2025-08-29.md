# üîí Bug Bounty Report: Information Disclosure - Grafana CloudFront

## üìã Informa√ß√µes do Report

**Data:** 29/08/2025  
**Severidade:** Medium  
**Categoria:** Information Disclosure  
**Dom√≠nio:** grabpay.com  
**Endpoint:** https://grafana.grabpay.com  

## üéØ Resumo Executivo

Foi identificada uma vulnerabilidade de **Information Disclosure** no endpoint do Grafana do GrabPay. A p√°gina de erro exp√µe informa√ß√µes sens√≠veis de debug, incluindo Request IDs √∫nicos e detalhes da configura√ß√£o CloudFront que podem ser utilizados para reconhecimento de infraestrutura.

## üîç Descri√ß√£o Detalhada

### Endpoint Afetado
- **URL:** `https://grafana.grabpay.com`
- **Status:** 403 Forbidden
- **Servidor:** CloudFront
- **Tipo:** Information Disclosure

### Evid√™ncia T√©cnica

#### Teste 1: Verifica√ß√£o de Headers
```bash
curl -s -I "https://grafana.grabpay.com"
HTTP/2 403 
server: CloudFront
date: Fri, 29 Aug 2025 05:30:16 GMT
content-type: text/html
content-length: 919
x-cache: Error from cloudfront
via: 1.1 f896274c80d0d1417cbf3b17f992a502.cloudfront.net (CloudFront)
x-amz-cf-pop: FOR50-P5
x-amz-cf-id: dJ4JYSOnJ1tpD_UClknsXJz5PVKuS2DodrFxbP2fYmAoI4-FyvEFnw==
```

#### Teste 2: Informa√ß√µes Expostas no Corpo da Resposta
```html
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<TITLE>ERROR: The request could not be satisfied</TITLE>
</HEAD><BODY>
<H1>403 ERROR</H1>
<H2>The request could not be satisfied.</H2>
<HR noshade size="1px">
Request blocked.
We can't connect to the server for this app or website at this time. There might be too much traffic or a configuration error. Try again later, or contact the app or website owner.
<BR clear="all">
If you provide content to customers through CloudFront, you can find steps to troubleshoot and help prevent this error by reviewing the CloudFront documentation.
<BR clear="all">
<HR noshade size="1px">
<PRE>
Generated by cloudfront (CloudFront)
Request ID: 9pnbtVVo5xkq0egGYpGtAw8E3Tln5VVFvrgSBbkhFPRChkGnK5-LIA==
</PRE>
<ADDRESS>
</ADDRESS>
</BODY></HTML>
```

### Informa√ß√µes Sens√≠veis Expostas

#### 1. **Request ID √önico**
```
Request ID: 9pnbtVVo5xkq0egGYpGtAw8E3Tln5VVFvrgSBbkhFPRChkGnK5-LIA==
```

#### 2. **Headers de Infraestrutura**
```
x-cache: Error from cloudfront
x-amz-cf-pop: FOR50-P5
x-amz-cf-id: dJ4JYSOnJ1tpD_UClknsXJz5PVKuS2DodrFxbP2fYmAoI4-FyvEFnw==
```

#### 3. **Detalhes de Configura√ß√£o**
- CloudFront configuration details
- Server architecture information
- Error handling patterns
- Geographic location (FOR50-P5)

## ‚ö†Ô∏è Impacto da Vulnerabilidade

### 1. **Reconhecimento de Infraestrutura**
- Request IDs podem ser usados para tracking de requests
- Informa√ß√µes sobre CloudFront podem ajudar em ataques
- Detalhes de configura√ß√£o podem revelar padr√µes de seguran√ßa

### 2. **Informa√ß√µes de Debug Expostas**
- Request IDs √∫nicos expostos publicamente
- Detalhes de erro podem revelar configura√ß√µes internas
- Informa√ß√µes sobre a stack tecnol√≥gica

### 3. **Potencial para Ataques**
- Request IDs podem ser usados para correlacionar requests
- Informa√ß√µes de infraestrutura podem ajudar em reconhecimento
- Detalhes de erro podem revelar vulnerabilidades adicionais

## üéØ Cen√°rios de Explora√ß√£o

### Cen√°rio 1: Tracking de Requests
```bash
# Request ID pode ser usado para correlacionar requests
Request ID: 9pnbtVVo5xkq0egGYpGtAw8E3Tln5VVFvrgSBbkhFPRChkGnK5-LIA==
```

### Cen√°rio 2: Reconhecimento de Infraestrutura
```bash
# Informa√ß√µes sobre CloudFront e localiza√ß√£o
x-amz-cf-pop: FOR50-P5  # S√£o Paulo, Brasil
x-amz-cf-id: dJ4JYSOnJ1tpD_UClknsXJz5PVKuS2DodrFxbP2fYmAoI4-FyvEFnw==
```

### Cen√°rio 3: An√°lise de Padr√µes
```bash
# M√∫ltiplos requests podem revelar padr√µes
curl -s "https://grafana.grabpay.com" | grep "Request ID"
```

## üîß Recomenda√ß√µes de Corre√ß√£o

### 1. **Remover Request IDs**
```html
<!-- Antes -->
<PRE>
Generated by cloudfront (CloudFront)
Request ID: 9pnbtVVo5xkq0egGYpGtAw8E3Tln5VVFvrgSBbkhFPRChkGnK5-LIA==
</PRE>

<!-- Depois -->
<PRE>
Generated by cloudfront (CloudFront)
Request ID: [REDACTED]
</PRE>
```

### 2. **Configurar P√°ginas de Erro Gen√©ricas**
```html
<!-- P√°gina de erro gen√©rica -->
<H1>Access Denied</H1>
<p>The requested resource is not available.</p>
```

### 3. **Remover Headers Sens√≠veis**
```nginx
# Configura√ß√£o CloudFront
server_tokens off;
add_header X-Content-Type-Options nosniff;
add_header X-Frame-Options DENY;
add_header X-XSS-Protection "1; mode=block";
```

### 4. **Implementar Logging Interno**
- Manter Request IDs apenas em logs internos
- N√£o expor informa√ß√µes de debug em produ√ß√£o
- Implementar monitoramento de seguran√ßa

## üìä Classifica√ß√£o de Severidade

### CVSS Score: 4.3 (Medium)
- **Attack Vector:** Network
- **Attack Complexity:** Low
- **Privileges Required:** None
- **User Interaction:** None
- **Scope:** Unchanged
- **Confidentiality Impact:** Low
- **Integrity Impact:** None
- **Availability Impact:** None

## üí∞ Valor Estimado

**Faixa de Recompensa:** $1,000 - $3,000  
**Justificativa:** Information disclosure de m√©dio impacto que pode facilitar reconhecimento de infraestrutura

## üîê Respons√°vel Disclosure

- ‚úÖ Vulnerabilidade identificada atrav√©s de testes autorizados
- ‚úÖ Nenhum dado sens√≠vel foi acessado ou modificado
- ‚úÖ Report enviado atrav√©s de canais oficiais
- ‚úÖ Aguardando resposta da equipe de seguran√ßa

## üìû Contato

**Researcher:** [Seu Nome]  
**Email:** [seu-email@domain.com]  
**HackerOne:** [seu-username]  

---

**Nota:** Este report foi criado seguindo as melhores pr√°ticas de responsible disclosure. Todas as informa√ß√µes s√£o confidenciais at√© a resolu√ß√£o da vulnerabilidade.
